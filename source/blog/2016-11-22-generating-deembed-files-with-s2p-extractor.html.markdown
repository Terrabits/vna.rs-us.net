---
published: false
title:  "Generating Deembed Files with S2P Extractor"
date:   2016-11-22 15:00
tags:   Deembedding, Fixture, Board
lead_text: >
  The S2P Extractor utility can be used to generate deembedding files for board and fixture setups.
---

S2P Extractor works on the premise that the corrections generated by calibrating hold precise information about the networks that they calibrated out. If we perform two calibrations, one just short of a particular feature and one that includes it, we should be able to compare the corrections that are generated to infer the response of the desired feature.

You can think of it as "subtracting" two calibrations to get the difference.

Installation
------------

S2P Extractor is a free utility. It can be downloaded from:

(S2P Extractor)[https://vna.rs-us.net/applications/s2p_extractor.html]

Copy the installer to the VNA and double-click to install.

S2P Extractor is available from the `External Tools` menu on the VNA.

For a ZVA:  
`System Config (hard key) -> "- More - (1/2)" (soft key) -> External Tools (soft key) -> S2P Extractor (soft key)`

For a ZNB(T):
`Applic (hard key) -> External Tools (tab) -> S2P Extractor (soft key)`

Generating Deembed Files for a PCB
----------------------------------

Here's an example. Assume the following:

- VNA
- coaxial cables
- Cal unit
- A PCB with TRL standards

We also assume that the VNA has already been configured for your project (start frequency, stop frequency, points, power etc)

<<parts>>

The first step is to perform a UOSM calibration to the end of the coaxial cables using the cal unit. This should be easy, since (hopefully) the coaxial cables and the cal unit can be connected directly. Automated calibration with a cal unit is also fast.

This calibration should be saved for later use.

<<UOSM>>

The next step is to perform the manual TRL calibration using the standards on the board. This is much more time consuming.

This calibration should also be saved for use later.

The corrections generated from the first (UOSM) calibration will have embedded in them the response of the system up to and including the cables.

The corrections generated from the second (TRL) calibration have embedded in them the response of the VNA, cables, and the connector+trace paths.

With some math, we can use the difference between the first calibration and the second calibration to generate the deembedding file for that path difference.

Open the S2P Extractor utility.

Specify the outer (UOSM) and inner (TRL) calibrations. Also specify the ports that were used.

Note: Single port (OSM) calibrations are not supported as of version 1.6. Support will be added in a subsequent release.

Click `Generate`.

The next window will ask you to specify a location and filename for the deembedding files. The files will be in touchstone (S2P) format, one for each path/port.

Click `Ok`

You should now have deembedding files for your board.

Deembedding on the VNA
----------------------

The deembedding feature of the VNA can be found in the following menus.

On a ZVA:  


On a ZNB(T):  
`Offset Embed (hard key) -> Single Ended (tab)`

The default touchstone file port ordering for S2P Extractor and the VNA matches, so there is no need to change it.

Applying the first (UOSM) calibration and the deembedding files provides a calibration plane at the DUT without performing the manual TRL calibration again. This should be accurate so long as your board characteristics do not drift over time.

