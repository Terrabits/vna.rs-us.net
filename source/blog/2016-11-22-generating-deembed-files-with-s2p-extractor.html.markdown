---
published: false
title:  "Generating Deembed Files with S2P Extractor"
date:   2016-11-22 15:00
tags:   Deembedding, Fixture, Board
lead_text: >
  The S2P Extractor utility can be used to generate deembedding files for PCB traces and fixture paths.
---

S2P Extractor works on the premise that the corrections generated by calibrating hold precise information about the networks that they calibrated out. If we perform two calibrations, one just before a particular feature and one that includes it, we should be able to compare the corrections that are generated to infer the response of the desired feature.

You can think of it as "subtracting" two calibrations to get the difference.

In this example deembedding files are generated for a PCB assuming the following equipment:

- Rohde & Schwarz VNA
- coaxial cables
- R&S Cal unit connected via USB
- A PCB with TRL standards on it

Installation
------------

S2P Extractor is a free utility. It can be downloaded from:

(S2P Extractor)[https://vna.rs-us.net/applications/s2p_extractor.html]

Copy the installer onto the VNA and double-click to install. It is important to copy it onto the VNA hard drive; running the installer from a USB drive or mapped network drive may result in cryptic installation errors.

Once installed, S2P Extractor is available from the `External Tools` menu on the VNA.

For a ZVA:  
`System Config (hard key) -> "- More - (1/2)" (soft key) -> External Tools (soft key) -> S2P Extractor (soft key)`

For a ZNB(T):
`Applic (hard key) -> External Tools (tab) -> S2P Extractor (soft key)`

![Initial screenshot]()

Generating Deembed Files for a PCB
----------------------------------

We also assume that the VNA has already been configured for your project (start frequency, stop frequency, points, power etc)

![Equipment on display]()

### Outer Calibration
The first step is to perform a UOSM calibration to the end of the coaxial cables using the cal unit. This should be easy, since (hopefully) the coaxial cables and the cal unit can be connected directly. Automated calibration with a cal unit is also fast.

This calibration should be saved for later use.

![Equipment set up for the outer, UOSM calibration with cal unit]()

### Inner Calibration
The next step is to perform the manual TRL calibration using the standards on the board. This is much more time consuming.

This calibration should also be saved for use later.

![Equipment set up for the inner, TRL calibration]()

### Generating Deembed Files

The corrections generated from the first (UOSM) calibration will have embedded in them the response of the system up to and including the cables.

The corrections generated from the second (TRL) calibration have embedded in them the response of the VNA, cables, and the connector+trace paths.

With some math, we can use the difference between the first calibration and the second calibration to generate the deembedding file for that path difference.

Open the S2P Extractor utility.

Specify the outer (UOSM) and inner (TRL) calibrations. Also specify the ports that were used.

Note: Single port (OSM) calibrations are not supported as of version 1.6. Support will be added in a subsequent release.

![S2P Extractor with calibration settings]()

Click `Generate`.

The next window will ask you to specify a location and filename for the deembedding files. The files will be in touchstone (S2P) format, one for each path/port.

![S2P Extractor filename dialog]()

Click `Ok`

You should now have deembedding files for your board.

Applying Deembedding on the VNA
-------------------------------

The deembedding feature of the VNA can be found in the following menus.

On a ZVA:

``

On a ZNB(T):

`Offset Embed (hard key) -> Single Ended (tab)`

Note: The default touchstone file port ordering for S2P Extractor and the VNA matches. If both are left at their defaults, the deembedding should occur correctly.

Applying the outer (UOSM) calibration performed above and the deembedding files provides a calibration plane at the DUT. And, in the future, an outer UOSM calibration and deembedding will provide comparable results to performing TRL on-board without requiring TRL standards on-board or performing a time consuming TRL calibration.

This should will be accurate so long as your board characteristics aren't changed and/or don't drift over time.
